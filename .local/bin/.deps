#!/usr/bin/env sh
# vi: ft=sh

if command -v pacman >/dev/null; then
    if ! command -v paru >/dev/null; then
        sudo pacman -S base-devel rustup git
        rustup install stable
        rustup default stable
        git clone https://aur.archlinux.org/paru.git /tmp/paru
        pwd=$(pwd)
        cd /tmp/paru || exit
        makepkg -si
        cd "$pwd" || exit
    fi

    paru -S --needed \
        adw-gtk-theme \
        alacritty \
        alsa-firmware \
        alsa-utils \
        avahi \
        bat \
        bear \
        bind \
        blueman \
        bluez \
        bluez-utils \
        breeze \
        brightnessctl \
        btop \
        chromium \
        cronie \
        curl \
        discord \
        dolphin \
        duf \
        dysk \
        ethtool \
        eza \
        fastfetch \
        fd \
        firefox \
        fish \
        fprintd \
        fzf \
        git \
        gnu-free-fonts \
        gnupg \
        grimblast-git \
        gst-libav \
        gst-plugins-bad \
        gst-plugins-base \
        gst-plugins-good \
        gst-plugins-ugly \
        hypridle \
        hyprland \
        hyprlock \
        hyprpaper \
        hyprpicker \
        hyprpolkitagent \
        kooha \
        lazygit \
        libadwaita \
        man-db \
        neovim \
        networkmanager \
        nmap \
        nodejs \
        noto-fonts-cjk \
        noto-fonts-emoji \
        npm \
        nwg-displays \
        papirus-icon-theme \
        pass \
        pass-otp \
        pavucontrol \
        pipewire \
        pipewire-alsa \
        pipewire-pulse \
        power-profiles-daemon \
        python-tldextract \
        qalculate-qt \
        qt5-wayland \
        qt5ct \
        qt6-wayland \
        qt6-webengine \
        qt6ct \
        qutebrowser \
        reflector \
        ripgrep \
        rofi \
        rustup \
        sddm \
        sof-firmware \
        spotify-launcher \
        starship \
        stow \
        swaync \
        swayosd \
        tealdeer \
        teams-for-linux \
        terminus-font \
        thunderbird \
        tmux \
        ttf-hack \
        ttf-hack-nerd \
        ttf-noto-nerd \
        ttf-roboto \
        ttf-roboto-mono \
        ttf-roboto-mono-nerd \
        ufw \
        unzip \
        waybar \
        wget \
        wireless-regdb \
        wireplumber \
        wl-clipboard \
        woff2-font-awesome \
        xdg-desktop-portal-hyprland \
        zerotier-one \
        zoxide

    sudo systemctl enable ufw

    sudo ufw allow http
    sudo ufw allow https
    sudo ufw allow ssh
    sudo ufw allow mdns
    sudo ufw allow 42069                                      # COT port
    sudo ufw allow 9993/udp                                   # zerotier port
    sudo ufw allow proto udp from any to any port 27031:27036 # steam
    sudo ufw allow proto tcp from any to any port 27040       # steam

    sudo ufw enable
fi

if command -v brew >/dev/null; then
    brew install \
        alacritty \
        bat \
        bear \
        btop \
        eza \
        fastfetch \
        fd \
        fish \
        fzf \
        git \
        lazygit \
        neovim \
        nodejs \
        npm \
        ripgrep \
        rustup \
        starship \
        stow \
        tldr \
        tmux \
        unzip \
        zoxide
fi

if command -v apt-get >/dev/null; then
    sudo apt-get update

    sudo apt-get install -y \
        alacritty \
        bat \
        bear \
        btop \
        duf \
        eza \
        fastfetch \
        fd-find \
        fish \
        fzf \
        git \
        lazygit \
        libssl-dev \
        neovim \
        nodejs \
        npm \
        pkg-config \
        python3 \
        python3-venv \
        ripgrep \
        rustup \
        starship \
        stow \
        tldr \
        tmux \
        unzip \
        zoxide
fi

rustup install stable
rustup default stable

cargo install quoty
cargo install fnm

touch "$HOME/.files/.deps.lock"
